<ion-header [translucent]="true">
  <ion-toolbar>

    <ion-buttons slot="start">
      <ion-button (click)="goBackTodo()" class="back-button">
        <ion-icon name="arrow-back-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>
      Edit Profile
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="padding-page" *ngIf="user !== null">

    <!-- <div class="page-title">Modifier profil</div> -->

    <!-- <app-user-card [user]="user"></app-user-card> -->

    <ion-list [class.disabled-form]="editMail">


      <div class="profile-image-pseudos">

        <div class="pseudo-image">
          <div class="image-container" (click)="triggerFileInput()">
            <img [src]="imagePreview || user.avatar" alt="Profile picture">
            <div class="overlay">
              <ion-icon name="pencil"></ion-icon>
            </div>
          </div>
          <input #fileInput type="file" accept="image/*" (change)="fileUpload($event)" style="display: none;" />
        </div>
    
        <ion-item class="item-margin pseudo-input">
          <ion-input type="text" 
          label="Pseudo" labelPlacement="floating" aria-label="Pseudo" 
          [(ngModel)]="user.pseudo"></ion-input>
        </ion-item>

      </div>

    

    

      <ion-item class="item-margin" [disabled]="editMail">
        <ion-input type="text" 
        label="Bio" labelPlacement="floating" aria-label="Email" 
        [(ngModel)]="user.bio"></ion-input>
      </ion-item>

    </ion-list>



      <ion-item class="item-margin">
        <ion-input type="text"
          [label]="editMail ? 'Changer email' : 'Email'"
          labelPlacement="floating" 
          aria-label="Email"
          [ngModel]="editMail ? newEmail : user.email"
          (ngModelChange)="newEmail = $event"
          [readonly]="!editMail">
        </ion-input>

        

        <ion-button slot="end" color="medium" (click)="editMail = !editMail">
          {{editMail ? 'Annuler' : 'Modifier'}}
        </ion-button>
      </ion-item>

      <!-- <div *ngIf="editMail">
        <ion-input type="text" 
        label="Nouvel Email" labelPlacement="floating" aria-label="Nouvel Email" 
        [(ngModel)]="newEmail"></ion-input>
      </div> -->

    <div *ngIf="errorMessageMail" class="error-message">{{errorMessageMail}}</div>

    <ion-button *ngIf="editMail" [disabled]="!validEmail()" (click)="modifyEmail()" class="big-button">Sauvegarder</ion-button>


      





      <ion-item class="item-margin" [disabled]="editMail">
        <ion-input type="password" 
        label="Password" labelPlacement="floating" aria-label="Status" value="************" readonly></ion-input>

        <ion-button slot="end" color="medium" (click)="{}" [disabled]="editMail">
          Modifier
        </ion-button>
      </ion-item>
    

    <!-- <ion-button [disabled]="!canModifyUser() || editMail" (click)="modifyUser()" expand="block" class="big-button">Sauvegarder</ion-button> -->

    <ion-item class="item-margin" [disabled]="editMail">
      <ion-label>Supprimer</ion-label>
    </ion-item>
  </div>
</ion-content>
